<template>
  <layout>
    <section class="contact-holder border-b-l-white">
      <div class="container pb-5 pt-5 pt-md-0">
        <div class="row">
          <div class="col-sm-7">
            <div class="d-sm-flex align-items-center">
              <img
                src="blubies/images/order-logo-2.png"
                class="order-logo ml-3"
                alt=""
              />
              <div>
                <h2>اسم الشركة</h2>
                <ul class="list-unstyled list-inline m-0">
                  <li class="list-inline-item m-0">
                    <i class="fa fa-map-marker-alt ml-1"></i>الرياض
                  </li>
                  <li class="list-inline-item mr-3">
                    <i class="fa fa-car ml-1"></i>قطاع النقل والمواصلات
                  </li>
                </ul>
                <div class="text-primary">
                  <i class="fa fa-star"></i>
                  <i class="fa fa-star"></i>
                  <i class="fa fa-star"></i>
                  <i class="far fa-star"></i>
                  <i class="far fa-star"></i>
                </div>
              </div>
            </div>
          </div>

          <div class="col-sm-5 text-left">
            <ul class="list-unstyled list-inline m-0 mt-3">
              <li class="list-inline-item mx-1">
                <div class="font-2x font-3x">70</div>
                <small>إعلان</small>
              </li>
              <li class="list-inline-item mx-1">
                <div class="font-2x font-3x">60</div>
                <small>متقدم</small>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!--===============================
    MAP
===================================-->
<!-- <div id="map"></div> -->
<!-- <section class="contact-holder border-b-l-white">
      <div class="container pb-5 pt-5 pt-md-0">
        <div class="row">
           <div class="mapouter">
              <div class="gmap_canvas">
                <iframe width="1770" height="510" id="gmap_canvas" src="https://maps.google.com/maps?q=california&t=&z=10&ie=UTF8&iwloc=&output=embed" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
              </div>
            </div>
          </div>
      
  
        </div>
  
        
    </section> -->

    <section class="content-holder move-up">
      <div class="container pb-5">
        <div class="row">
          <div class="col-sm-6 col-md-4">
            <div class="card animate-box">
              <div class="card-body">
                <i class="fa fa-map-marker-alt font-2x"></i>
                <p class="m-0">العنوان</p>
                <h5 class="m-0">طريق الملك عبد العزيز, حي العليا</h5>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-md-4">
            <div class="card animate-box">
              <div class="card-body">
                <i class="fa fa-phone-volume font-2x"></i>
                <p class="m-0">رقم الهاتف</p>
                <h5 class="m-0">
                  <a href="tel:+966123456789" title="">+966123456789</a>
                </h5>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-md-4">
            <div class="card animate-box">
              <div class="card-body">
                <i class="far fa-envelope font-2x"></i>
                <p class="m-0">البريد الاكتروني</p>
                <h5 class="m-0">
                  <a href="mailto:mail@email.com" title="">mail@email.com</a>
                </h5>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 my-3">
            <a href="#"
              ><img
                src="https://via.placeholder.com/768x90"
                alt="..."
                class="img-fluid"
            /></a>
          </div>
          <div class="col-md-6 my-3">
            <a href="#"
              ><img
                src="https://via.placeholder.com/768x90"
                alt="..."
                class="img-fluid"
            /></a>
          </div>
        </div>

        <div class="row">
          <div class="col-md-8 pt-4">
            <p class="m-0 text-muted">
              هناك حقيقة مثبتة منذ زمن طويل وهي أن المحتوى المقروء لصفحة ما
              سيلهي القارئ عن التركيز على الشكل الخارجي للنص أو شكل توضع الفقرات
              في الصفحة التي يقرأها. ولذلك يتم استخدام طريقة لوريم إيبسوم لأنها
              تعطي توزيعاَ طبيعياَ -إلى حد ما- للأحرف عوضاً عن استخدام "هنا يوجد
              محتوى نصي، هنا يوجد محتوى نصي" فتجعلها تبدو (أي الأحرف) وكأنها نص
              مقروء.
            </p>
            <p class="m-0 text-muted">
              هناك حقيقة مثبتة منذ زمن طويل وهي أن المحتوى المقروء لصفحة ما
              سيلهي القارئ عن التركيز على الشكل الخارجي للنص أو شكل توضع الفقرات
              في الصفحة التي يقرأها. ولذلك يتم استخدام طريقة لوريم إيبسوم لأنها
              تعطي توزيعاَ طبيعياَ -إلى حد ما- للأحرف عوضاً عن استخدام "هنا يوجد
              محتوى نصي، هنا يوجد محتوى نصي" فتجعلها تبدو (أي الأحرف) وكأنها نص
              مقروء.
            </p>
            <div class="collapse" id="aboutOrder">
              <p class="m-0 text-muted">
                هناك حقيقة مثبتة منذ زمن طويل وهي أن المحتوى المقروء لصفحة ما
                سيلهي القارئ عن التركيز على الشكل الخارجي للنص أو شكل توضع
                الفقرات في الصفحة التي يقرأها. ولذلك يتم استخدام طريقة لوريم
                إيبسوم لأنها تعطي توزيعاَ طبيعياَ -إلى حد ما- للأحرف عوضاً عن
                استخدام "هنا يوجد محتوى نصي، هنا يوجد محتوى نصي" فتجعلها تبدو
                (أي الأحرف) وكأنها نص مقروء.
              </p>
            </div>
            <a
              data-toggle="collapse"
              href="#aboutOrder"
              role="button"
              aria-expanded="false"
              aria-controls="aboutOrder"
              title="اقرأ المزيد عن الطلب"
              >اقرأ المزيد عن الطلب<i class="fa fa-chevron-down mr-1"></i
            ></a>

            <h3 class="mt-4">المرفقات</h3>
            <div class="row">
              <div class="col-lg-6">
                <div class="card border animate-box">
                  <div
                    class="card-body d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <i class="far fa-copy font-1x"></i>
                      <h5>الملف التأميني الخاص</h5>
                      <p class="m-0 text-muted">
                        <i class="fa fa-clock ml-1"></i> 14 اغسطس 2019
                      </p>
                    </div>
                    <a
                      href="#"
                      class="btn p-0 pt-1 round-icon btn-outline-primary"
                      title="تحميل"
                      ><i class="icofont-long-arrow-down font-2x"></i
                    ></a>
                  </div>
                </div>
              </div>

              <div class="col-lg-6">
                <div class="card border animate-box">
                  <div
                    class="card-body d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <i class="far fa-copy font-1x"></i>
                      <h5>الملف التأميني الخاص</h5>
                      <p class="m-0 text-muted">
                        <i class="fa fa-clock ml-1"></i> 14 اغسطس 2019
                      </p>
                    </div>
                    <a
                      href="#"
                      class="btn p-0 pt-1 round-icon btn-outline-primary"
                      title="تحميل"
                      ><i class="icofont-long-arrow-down font-2x"></i
                    ></a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 text-center my-3">
            <ul class="list-unstyled list-inline social-links">
              <li class="list-inline-item m-0 ml-2">
                <a href="#" title="facebook"
                  ><i class="fab fa-facebook-f"></i
                ></a>
              </li>
              <li class="list-inline-item m-0 ml-2">
                <a href="#" title="twitter"><i class="fab fa-twitter"></i></a>
              </li>
              <li class="list-inline-item m-0 ml-2">
                <a href="#" title="linkedin"
                  ><i class="fab fa-linkedin-in"></i
                ></a>
              </li>
              <li class="list-inline-item m-0 ml-2">
                <a href="#" title="link"
                  ><i class="fa fa-link text-dark"></i
                ></a>
              </li>
            </ul>
            <a href="#"
              ><img
                src="https://via.placeholder.com/336x280"
                alt="..."
                class="img-fluid"
            /></a>
          </div>
        </div>

        <h2 class="my-4">الطلبات المضافة</h2>
        <div class="row orders-holder">
          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4">
            <div class="animate-box">
              <div class="card">
                <div class="card-body py-4">
                  <div class="row">
                    <div class="col">
                      <span class="round-icon"><i class="fa fa-city"></i></span>
                    </div>
                    <div class="col text-left">
                      <a
                        href="#"
                        title="طلب عرض اسعار"
                        class="btn btn-sm btn-outline-light mt-1"
                        >طلب عرض اسعار</a
                      >
                    </div>
                  </div>

                  <h3 class="mt-4 mb-5">تأمين صحي</h3>

                  <ul class="list-unstyled list-inline text-muted">
                    <li class="list-inline-item m-0">
                      <i class="icofont-google-map ml-1"></i> الرياض
                    </li>
                    <li class="list-inline-item mr-2">
                      <i class="icofont-clock-time ml-1"></i>
                      <span class="d-inline-block"> 14 اغسطس, 2019</span>
                    </li>
                  </ul>

                  <img
                    src="blubies/images/order-logo-1.png"
                    alt="logo"
                    class="order-logo"
                  />

                  <a href="order-single.html" title="التفاصيل" class="order-btn"
                    ><i class="fa fa-chevron-left"></i> التفاصيل</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="text-left">
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li class="page-item"><a class="page-link" href="#">1</a></li>
              <li class="page-item active">
                <a class="page-link" href="#">2</a>
              </li>
              <li class="page-item"><a class="page-link" href="#">3</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </section>
  </layout>
</template>
<script>
import Layout from "../Layout.vue";
import "@fortawesome/fontawesome-free/css/all.css";
import UserTabs from "./UserTabs";

import axios from "axios";
export default {
  name: "Dashboard Settings",

  components: {
    Layout,
    UserTabs
  },
  beforeUnmount() {},
  created() {},

  data() {
    return {
      payments: [],
      currentPassword: "",
      newPassword: "",
      confirmPassword: "",
      errors: {},
      successMessage: false,
      errorMessage: false,
      showSuccessMessage: false, // Flag to show the success message
      email: "",
      editedCoupon: {
        id: null,
        code: "",
        discount: "",
        // Add other fields as needed
      },
      user: {
        id: "",
        first_name: "",
        last_name: "",
        email: "",
        phonenumber: "",
        address: "",
        country: "",
        companyname: "",
        type: "request",

        // other user properties
      },

      invitations: "",
      discount: 0,
      is_active: 0, // Initialize with 0 for unchecked
      successMessage: null,
      errorMessage: null,
      processing: false,
      activeTab: 1,
      coupons: [],
      deleteCouponId: null, // To store the ID of the coupon to delete
      showDeleteConfirmation: false, // To control the visibility of the delete confirmation dialog
      showCouponCodeModal: false, // To control the visibility of the delete confirmation dialog
      showCouponCodeDiscountModal: false,
      isModalVisible: false,
      discount: 0,
      loggedIn: false,
      showDiscountError: false,
      cardNumber: "",
      expiryDate: "",
      expiryYear: "",
      cvv: "",

      years: [], // Array to store years
    };
  },
  watch: {
    discount(newDiscount) {
      console.log(newDiscount);
      if (newDiscount < 0 || newDiscount > 100) {
        console.log("true", newDiscount);
        this.showDiscountError = true;
      } else {
        this.showDiscountError = false;
      }
    },
  },
  mounted() {
    this.getpayments();
    this.generateYearOptions();
    // Get the authentication token from where you store it (e.g., Vuex store or local storage)
    const authToken = "Bearer " + localStorage.getItem("token"); // Replace with your storage method
    // Make an API call to fetch user data with the authentication token
    axios
      .get("/api/user", {
        headers: {
          Authorization: authToken,
        },
      })
      .then((response) => {
        // Set the retrieved user data to the 'user' property
        this.user = response.data;
      })
      .catch((error) => {
        console.error("Error fetching user data:", error);
      });
    axios
      .get("/api/get-invitation", {})
      .then((response) => {
        // Set the retrieved user data to the 'user' property
        this.invitations = response.data;
      })
      .catch((error) => {
        console.error("Error fetching user data:", error);
      });
  },

  methods: {
    // initMap() {
    //   var mainLocation = {
    //     lat: 21.487239,
    //     lng: 39.1876989,
    //   };

    //   var map = new google.maps.Map(document.getElementById("map"), {
    //     zoom: 14,
    //     center: mainLocation,
    //   });

    //   var image = {
    //     url: "blubies/images/map-icon.png",
    //     size: new google.maps.Size(35, 35),
    //     scaledSize: new google.maps.Size(35, 35),
    //   };
    //   var beachMarker = new google.maps.Marker({
    //     map: map,
    //     icon: image,
    //     position: mainLocation,
    //     animation: google.maps.Animation.DROP,
    //   });
    // },
    generateYearOptions() {
      const currentYear = new Date().getFullYear();
      for (let i = 0; i < 10; i++) {
        this.years.push(currentYear + i); // Generate 10 future years
      }
    },
    updatePassword() {
      // Retrieve data from local storage
      const dataFromLocalStorage = localStorage.getItem("user"); // Replace 'user' with your storage key

      // Include the data from local storage in the payload
      const payload = {
        localStorageData: dataFromLocalStorage,
        currentPassword: this.currentPassword,
        newPassword: this.newPassword,
        confirmPassword: this.confirmPassword,
      };

      axios
        .post("api/update-password", payload)
        .then((response) => {
          console.log(response);

          // Reset form fields after a successful update
          this.currentPassword = "";
          this.newPassword = "";
          this.confirmPassword = "";

          // Show success message
          this.successMessage = "تم تحديث كلمة السر بنجاح";
          setTimeout(() => {
            this.successMessage = null;
          }, 5000);

          // Clear error message
          this.errorMessage = null;
        })
        .catch((error) => {
          if (error.response && error.response.status === 422) {
            // Handle validation errors
            this.errors = error.response.data.errors;
            this.errorMessage = "حدث خطأ أثناء تحديث كلمة المرور";
          } else {
            // Handle other errors
            console.error("Error updating password:", error);
            this.errorMessage = "حدث خطأ أثناء تحديث كلمة المرور";
          }

          // Clear success message
          this.successMessage = null;
        });
    },
    handleSubmit() {
      const formData = {
        card_number: this.cardNumber,
        expiry_date: this.expiryDate,
        expiry_year: this.expiryYear,
        cvv: this.cvv,
      };

      // Make an API call using Axios (assuming Axios is installed)
      // Replace 'apiEndpoint' with your Laravel API endpoint
      axios
        .post("api/add-payment", formData)
        .then((response) => {
          this.cardNumber = "";
          this.expiryDate = "";
          this.expiryYear = "";
          this.cvv = "";
          console.log("Payment created:", response.data);
          this.payments.push(response.data.payment);
          // Handle success as needed
          this.showSuccessMessage = "تم إنشاء الدفع بنجاح.";
          this.showSuccessMessage = true;
          setTimeout(() => {
            this.showSuccessMessage = null;
          }, 5000);
        })
        .catch((error) => {
          console.error("Error creating payment:", error.response.data);
          // Handle errors
        });
    },

    InvitationForm() {
      if (!this.email || !this.email.includes("@")) {
        setTimeout(() => {
          this.errors.email = "يرجى إدخال بريد إلكتروني صالح";
        }, 5000);

        return;
      }
      // Retrieve data from local storage
      const dataFromLocalStorage = localStorage.getItem("user"); // Replace 'user' with your storage key

      // Include the data from local storage in the payload
      const payload = {
        localStorageData: dataFromLocalStorage,
        email: this.email,
      };

      axios
        .post("api/Invitation-sent", payload)
        .then((response) => {
          console.log(response);

          // Reset form fields after a successful update
          this.email = "";

          // Show success message

          this.successMessage = "User Account updated Successfully.";
          this.showSuccessMessage = true;
          setTimeout(() => {
            this.showSuccessMessage = null;
          }, 5000);

          // Clear error message
          this.errorMessage = null;
        })
        .catch((error) => {
          if (error.response && error.response.status === 422) {
            // Handle validation errors
            this.errors = error.response.data.errors;
            this.errorMessage = "حدث خطأ أثناء تحديث كلمة المرور";
          } else {
            // Handle other errors
            console.error("Error updating password:", error);
            this.errorMessage = "حدث خطأ أثناء تحديث كلمة المرور";
          }

          // Clear success message
          this.successMessage = null;
        });
    },

    logout() {
      localStorage.removeItem("user");
      localStorage.removeItem("token");
      if (this.$route.path != "/") this.$router.push("/");
      else location.reload();
    },
    confirmDelete(couponId) {
      console.log("Coupon ID:", couponId);
      this.deleteCouponId = couponId;
      this.showDeleteConfirmation = true;
    },

    showCouponCode() {
      this.showCouponCodeModal = true;
    },
    showCouponCodeDiscount() {
      this.showCouponCodeDiscountModal = true;
      axios
        .get("/api/coupon-settings")
        .then((response) => {
          // Assuming your API response has a 'coupon' property
          this.discount = response.data.coupon;
        })
        .catch((error) => {
          console.error("Error fetching coupon data:", error);
        });
    },
    getpayments() {
      axios
        .get("/api/payment")
        .then((response) => {
          this.payments = response.data.payments; // Assuming API response contains payments array
          console.log(this.payments);
        })
        .catch((error) => {
          console.error("Error fetching payments:", error);
        });
    },
    formatCardNumber(cardNumber) {
      if (typeof cardNumber === "string" && cardNumber.length >= 4) {
        // Use slice only if cardNumber is a string and has a length of at least 4
        return cardNumber.slice(-4).padStart(cardNumber.length, "*");
      }
      return "4141";
    },

    cancelcouponmodal() {
      this.showCouponCodeModal = false;
    },
    cancelDelete() {
      this.deleteCouponId = null;
      this.showDeleteConfirmation = false;
    },

    deleteConfirmed(id) {
      if (confirm("Are you sure you want to delete this invitation?")) {
        console.log(this.deleteInvitationId);
        console.log(id);

        axios
          .delete(`/api/delete-invitation/${id}`)
          .then(() => {
            // Remove the deleted record from the invitations array
            this.invitations = this.invitations.filter(
              (invitation) => invitation.id !== this.deleteInvitationId
            );

            // Close the confirmation dialog or do any necessary cleanup
            // For example, if using a modal for confirmation:
            this.cancelDelete(); // Assuming cancelDelete() closes the modal
          })
          .catch((error) => {
            // Handle delete error
            console.error("Error deleting invitation:", error);
            // Optionally show an error message
          });
      }
    },
    switchTab(tabNumber) {
      this.activeTab = tabNumber;
    },
    deletePayment(paymentId) {
      // alert(paymentId);
      axios
        .delete(`/api/payments/${paymentId}`)
        .then((response) => {
          // Remove the deleted payment from the local array
          this.payments = this.payments.filter(
            (payment) => payment.id !== paymentId
          );
          console.log("Payment deleted:", response.data);
        })
        .catch((error) => {
          console.error("Error deleting payment:", error);
        });
      if (confirm("Are you sure you want to delete this invitation?")) {
        axios
          .delete(`/api/payments/${paymentId}`)
          .then(() => {
            // Remove the deleted record from the invitations array
            this.payments = this.payments.filter(
              (payment) => payment.id !== paymentId
            );

            // Close the confirmation dialog or do any necessary cleanup
            // For example, if using a modal for confirmation:
            this.cancelDelete(); // Assuming cancelDelete() closes the modal
          })
          .catch((error) => {
            // Handle delete error
            console.error("Error deleting invitation:", error);
            // Optionally show an error message
          });
      }
    },
    updateSettings() {
      const authToken = "Bearer " + localStorage.getItem("token"); // Replace with your storage method
      // Check if passwords match before making the API request
      if (this.user.password !== this.user.password_confirmation) {
        this.passwordsDoNotMatch = true;
        return;
      }
      // Clear the error message if passwords match
      this.passwordsDoNotMatch = false;

      // Make the API request
      axios
        .put(
          "/api/user/update-general-setting",
          {
            first_name: this.user.first_name,
            last_name: this.user.last_name,
            phonenumber: this.user.phonenumber,
            address: this.user.address,
            country: this.user.country,
            companyname: this.user.companyname,
            type: this.user.type,
          },
          {
            headers: {
              Authorization: authToken,
            },
          }
        )
        .then((response) => {
          // Handle success, show a success message or redirect
          this.successMessage = "User Account updated Successfully.";
          this.showSuccessMessage = true;
          setTimeout(() => {
            this.showSuccessMessage = null;
          }, 5000);
        })
        .catch((error) => {
          // Handle error, show an error message or log the error
          console.error("Error updating user:", error);
          this.errorMessage =
            "The password field must be at least 8 characters";
          setTimeout(() => {
            this.errorMessage = null;
          }, 10000);
        });
    },
  },

  watch: {
    // Reset the error message when the user updates the password or confirmation
    "user.password": function () {
      this.passwordsDoNotMatch = false;
    },
    "user.password_confirmation": function () {
      this.passwordsDoNotMatch = false;
    },
  },
  computed: {
    formattedCreatedAt() {
      return moment(this.created_at).format("MMMM Do YYYY, h:mm:ss a");
    },
    mappedIsActiveValue() {
      return this.is_active ? 1 : 0;
    },
  },
};
</script>
<style>
.error-message {
  color: red;
  font-size: 0.9em;
  margin-top: 5px;
}

.success-message {
  color: green;
  font-size: 1.1em;
  margin-top: 10px;
}
</style>